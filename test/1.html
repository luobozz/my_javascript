<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Title</title>
    <script src="jq.js"></script>
    <script>
        function test() {
            var xtk = $("#xtk").val();
            var jk = $("#xtk1").val();
            var url = jk


            var xhr = new XMLHttpRequest();
            xhr.responseType = "arraybuffer";
            xhr.open("get", url, true);
            xhr.onload = function () {
                const blob = new Blob([this.response], {type: "application/vnd.ms-excel"});
                if (blob.size < 1) {
                    alert('导出失败，导出的内容为空！');
                    return;
                }
                if (window.navigator.msSaveOrOpenBlob) {
                    navigator.msSaveOrOpenBlob(blob, 'test.xls')
                } else {
                    const aLink = document.createElement('a');
                    aLink.style.display = 'none';
                    aLink.href = window.URL.createObjectURL(blob);
                    aLink.download = 'testxls';
                    document.body.appendChild(aLink);
                    aLink.click();
                    document.body.removeChild(aLink);
                    return;
                }
            }
            xhr.setRequestHeader("X-Access-Token", xtk);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.send(JSON.stringify({}));

        }
    </script>
</head>
<body>
<input id="xtk1" type="text" width="500" placeholder="输入接口"/>
<input id="xtk" type="text" width="500" placeholder="输入token"/>
<input type="button" onclick="test()" value="点击下载">
</body>
</html>